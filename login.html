<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Login - Tablón del Clan</title>

    <!-- CSS -->
    <link rel="stylesheet" href="style.css">

    <!-- Supabase (SIEMPRE ANTES DE TU JS) -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>

    <h1>LOGIN</h1>

    <div class="login-box">
        <input type="email" id="email" placeholder="Correo electrónico">
        <input type="password" id="password" placeholder="Contraseña">
        <button id="btnLogin">Ingresar</button>

        <p>¿No tienes cuenta? <a href="register.html">Regístrate</a></p>
    </div>

    <script>
        // Al hacer clic en Ingresar
        document.getElementById("btnLogin").addEventListener("click", async () => {

            const email = document.getElementById("email").value.trim();
            const pass = document.getElementById("password").value.trim();

            if (!email || !pass) {
                alert("Completa todos los campos.");
                return;
            }

            const { data, error } = await supabase.auth.signInWithPassword({
                email: email,
                password: pass
            });

            if (error) {
                alert("Error: " + error.message);
                return;
            }

            // Redirige al panel principal
            window.location.href = "index.html";
        });

        // Si ya está logueado, redirigir a index directo
        supabase.auth.getSession().then((res) => {
            if (res.data.session) {
                window.location.href = "index.html";
            }
        });
    </script>

</body>
</html>
